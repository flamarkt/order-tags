(()=>{var t={n:o=>{var e=o&&o.__esModule?()=>o.default:()=>o;return t.d(e,{a:e}),e},d:(o,e)=>{for(var n in e)t.o(e,n)&&!t.o(o,n)&&Object.defineProperty(o,n,{enumerable:!0,get:e[n]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},o={};(()=>{"use strict";t.r(o),t.d(o,{backoffice:()=>B,common:()=>D});const e=((flarum.extensions["flamarkt-backoffice"]||{}).backoffice||{}).app;var n=t.n(e);const r=flarum.core.compat["common/extend"],a=((flarum.extensions["flamarkt-backoffice"]||{}).common||{})["components/ActiveLinkButton"];var s=t.n(a);const i=((flarum.extensions["flamarkt-backoffice"]||{}).backoffice||{})["components/BackofficeNav"];var c=t.n(i);function u(t,o){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},u(t,o)}function f(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,u(t,o)}const l=flarum.core.compat["common/components/Page"];var p=t.n(l);const d=flarum.core.compat["common/components/LinkButton"];var h=t.n(d);const g=((flarum.extensions["flamarkt-backoffice"]||{}).common||{})["states/AbstractListState"];var v=function(t){function o(){return t.apply(this,arguments)||this}return f(o,t),o.prototype.type=function(){return"flamarkt/order-tags"},o}(t.n(g)());const y=((flarum.extensions["flamarkt-backoffice"]||{}).backoffice||{})["components/AbstractList"];var b=function(t){function o(){return t.apply(this,arguments)||this}f(o,t);var e=o.prototype;return e.head=function(){var o=t.prototype.head.call(this);return o.add("name",m("th","Name")),o},e.columns=function(o){var e=t.prototype.columns.call(this,o);return e.add("name",m("td",o.name()),10),e},e.actions=function(o){var e=t.prototype.actions.call(this,o);return e.add("edit",h().component({className:"Button Button--icon",icon:"fas fa-pen",href:n().route("orderTags.show",{id:o.id()})})),e},o}(t.n(y)()),k=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(o=t.call.apply(t,[this].concat(n))||this).listState=void 0,o}f(o,t);var e=o.prototype;return e.oninit=function(o){t.prototype.oninit.call(this,o),this.listState=new v,this.listState.refresh()},e.view=function(){return m(".OrderTagIndexPage",m(".container",[m(".Form-group",[h().component({className:"Button",href:n().route("orderTags.show",{id:"new"})},"New tag")]),m(b,{state:this.listState})]))},o}(p());const w=((flarum.extensions["flamarkt-backoffice"]||{}).common||{})["pages/AbstractShowPage"];var C=t.n(w);const x=((flarum.extensions["flamarkt-backoffice"]||{}).backoffice||{})["components/SubmitButton"];var T=t.n(x);const S=flarum.core.compat["common/components/LoadingIndicator"];var O=t.n(S);const P=flarum.core.compat["common/components/Switch"];var L=t.n(P);const A=flarum.core.compat["common/utils/ItemList"];var _=t.n(A),j=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(o=t.call.apply(t,[this].concat(n))||this).tag=null,o.dirty=!1,o.saving=!1,o.name="",o.visibleCustomer=!1,o.notifyCustomer=!1,o}f(o,t);var e=o.prototype;return e.newRecord=function(){return n().store.createRecord("flamarkt-order-tags")},e.findType=function(){return"flamarkt/order-tags"},e.show=function(t){this.tag=t,this.name=t.name()||"",this.visibleCustomer=!!t.visibleCustomer(),this.notifyCustomer=!!t.notifyCustomer(),n().setTitle(t.name()),n().setTitleCount(0)},e.view=function(){return this.tag?m("form.OrderTagShowPage",{onsubmit:this.onsubmit.bind(this)},m(".container",this.fields().toArray())):O().component()},e.fields=function(){var t=this,o=new(_());return o.add("name",m(".Form-group",[m("label","Name"),m("input.FormControl",{type:"text",value:this.name,oninput:function(o){t.name=o.target.value,t.dirty=!0}})])),o.add("visibleCustomer",m(".Form-group",[L().component({state:this.visibleCustomer,onchange:function(o){t.visibleCustomer=o,t.dirty=!0}},"Visible to customer")])),o.add("notifyCustomer",m(".Form-group",[L().component({state:this.notifyCustomer,onchange:function(o){t.notifyCustomer=o,t.dirty=!0}},"Notify customer when added")])),o.add("submit",m(".Form-group",[T().component({loading:this.saving,dirty:this.dirty,exists:this.tag.exists})]),-10),o},e.data=function(){return{name:this.name,visibleCustomer:this.visibleCustomer,notifyCustomer:this.notifyCustomer}},e.onsubmit=function(t){var o=this;t.preventDefault(),this.saving=!0,this.tag.save(this.data()).then((function(t){o.tag=t,o.saving=!1,o.dirty=!1,m.redraw(),m.route.set(n().route("orderTags.show",{id:t.id()}))})).catch((function(t){o.saving=!1,m.redraw()}))},o}(C()),B={"components/TagList":b,"pages/TagIndexPage":k,"pages/TagShowPage":j,"states/TagListState":v};const F=flarum.core.compat["common/Component"];var N=t.n(F),M=function(t){function o(){return t.apply(this,arguments)||this}return f(o,t),o.prototype.view=function(){return this.attrs.orderTag.name()},o}(N()),I=function(t){function o(){return t.apply(this,arguments)||this}return f(o,t),o.prototype.view=function(){return(this.attrs.orderTags||[]).map((function(t){return t?m(M,{orderTag:t}):null}))},o}(N());const R=flarum.core.compat["common/Model"];var q=t.n(R),z=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(o=t.call.apply(t,[this].concat(n))||this).slug=q().attribute("slug"),o.name=q().attribute("name"),o.visibleCustomer=q().attribute("visibleCustomer"),o.notifyCustomer=q().attribute("notifyCustomer"),o}return f(o,t),o.prototype.apiEndpoint=function(){return"/flamarkt/order-tags"+(this.exists?"/"+this.data.id:"")},o}(q()),D={"components/TagLabel":M,"components/TagLabels":I,"models/Tag":z};const E=flarum.core.compat["common/app"];var V=t.n(E);const G=((flarum.extensions["flamarkt-core"]||{}).common||{})["models/Order"];var H=t.n(G);const J=((flarum.extensions["flamarkt-core"]||{}).backoffice||{})["components/OrderList"];var K=t.n(J);const Q=((flarum.extensions["flamarkt-core"]||{}).backoffice||{})["pages/OrderShowPage"];var U=t.n(Q);const W=((flarum.extensions["flamarkt-backoffice"]||{}).common||{})["components/AbstractRelationshipSelect"];var X=t.n(W);const Y=flarum.core.compat["common/helpers/highlight"];var Z=t.n(Y),$=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(o=t.call.apply(t,[this].concat(n))||this).resultsCache=new Map,o}f(o,t);var e=o.prototype;return e.search=function(t){var o=this;return t?n().store.find("flamarkt/order-tags",{filter:{q:t},page:{limit:5}}).then((function(e){o.resultsCache.set(t,e),m.redraw()})):(m.redraw(),Promise.resolve())},e.results=function(t){if(!t)return[];t=t.toLowerCase();var o=this.resultsCache.get(t);return void 0===o?null:(o||[]).concat(n().store.all("flamarkt-order-tags").filter((function(o){return o.name().toLowerCase().substr(0,t.length)===t}))).filter((function(t,o,e){return e.lastIndexOf(t)===o})).sort((function(t,o){return t.name().localeCompare(o.name())}))},e.item=function(t,o){return[o?Z()(t.name(),o):t.name()]},o}(X());n().initializers.add("flamarkt-order-tags",(function(){V().store.models["flamarkt-order-tags"]=z,H().prototype.tags=q().hasMany("tags"),(0,r.extend)(K().prototype,"head",(function(t){t.add("tags",m("th","Tags"),60)})),(0,r.extend)(K().prototype,"columns",(function(t,o){t.add("tags",m("td",I.component({orderTags:o.tags()})),60)})),(0,r.extend)(U().prototype,"show",(function(){var t=this.order.tags();this.tags=Array.isArray(t)?t.filter((function(t){return void 0!==t})):[]})),(0,r.extend)(U().prototype,"fields",(function(t){var o=this;t.add("tags",m(".Form-group",[m("label","Tags"),$.component({relationship:this.tags,onchange:function(t){o.tags=t,o.dirty=!0}})]))})),(0,r.extend)(U().prototype,"data",(function(t){t.relationships=t.relationships||{},t.relationships.tags=this.tags})),n().routes["orderTags.index"]={path:"/order-tags",component:k},n().routes["orderTags.show"]={path:"/order-tags/:id",component:j},(0,r.extend)(c().prototype,"items",(function(t){t.add("order-tags",s().component({href:n().route("orderTags.index"),icon:"fas fa-tag",activeRoutes:["orderTags.*"]},"Order Tags"))}))}))})(),module.exports=o})();
//# sourceMappingURL=backoffice.js.map